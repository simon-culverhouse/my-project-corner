<!doctype html><html lang=fr><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140425106-2"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-140425106-2');</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Capteur de température et d’humidité connecté | My Project Corner</title><meta name=description content="Un capteur connecté au MQTT avec un affichage LCD pour surveiller les relevés de température et d&rsquo;humidité dans ma maison. J&rsquo;en ai construit trois &mldr;"><link rel=canonical href=https://myprojectcorner.com/fr/capteur-de-temperature-et-humidite-connecte/><base href=/fr><link rel=stylesheet href=https://myprojectcorner.com/css/styles.min.css><link rel=icon href=media/logo.png type=image/x-icon><script src=js/lazyload.min.js></script><script data-ad-client=ca-pub-1748277873952415 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header><nav class="w3-sidebar w3-bar-block w3-opacity-min w3-theme w3-animate-right w3-top w3-text-theme w3-large" style=z-index:3;width:250px;font-weight:700;display:none;right:0 id=mySidebar><a href=javascript:void(0) onclick=w3_close() class="w3-bar-item w3-button w3-animate-bottom w3-theme-d2 w3-xlarge sc-fade" style=text-align:right title=Fermer>X</a>
<a href=/fr onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme-l5 w3-padding-16 sc-fade" style=text-transform:uppercase title=Accueil>Accueil</a>
<a href=/fr/projects onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme-l5 w3-padding-16 sc-fade" style=text-transform:uppercase title=Projects>Projects</a>
<a href=/fr/categories onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme-l5 w3-padding-16 sc-fade" style=text-transform:uppercase title=Categories>Categories</a>
<a href=/fr/a_propos onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme-l5 w3-padding-16 sc-fade" style=text-transform:uppercase title="A propos">A propos</a>
<a href=/fr/contacter onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme-l5 w3-padding-16 sc-fade" style=text-transform:uppercase title=Contact>Contact</a><div class="w3-dropdown-hover w3-bar-item w3-center w3-theme-d5 w3-padding-16 w3-hide-medium w3-hide-large"><span style=padding-right:10px>Français</span><img src=media/world.png style=max-width:24px alt="language selector"></span><div class="w3-bar-block w3-dropdown-content w3-card-4" style=right:0;top:50px><a href=https://myprojectcorner.com/connected-temperature-humidity-sensor/ class="w3-bar-item w3-button sc-fade" style=text-align:center>English</a>
<a href=https://myprojectcorner.com/es/connected-temperature-humidity-sensor/ class="w3-bar-item w3-button sc-fade" style=text-align:center>Español</a></div></div></nav><div class="w3-top w3-theme"><div class=w3-bar><a href=javascript:void(0) class="w3-button w3-right w3-round w3-theme-action w3-xlarge w3-hide-large" onclick=w3_open()>☰</a>
<a href=index.html class=w3-bar-item><img src=media/logo.png style=max-height:36px alt="my project corner logo"></a>
<a href=index.html class="w3-bar-item w3-theme sc-header">My Project Corner</a>
<a href=/fr onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme w3-padding-16 w3-hide-small w3-hide-medium sc-fade" style=text-transform:uppercase title=Accueil><span style=color:#2196f3;font-weight:700>| </span>Accueil</a>
<a href=/fr/projects onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme w3-padding-16 w3-hide-small w3-hide-medium sc-fade" style=text-transform:uppercase title=Projects><span style=color:#2196f3;font-weight:700>| </span>Projects</a>
<a href=/fr/categories onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme w3-padding-16 w3-hide-small w3-hide-medium sc-fade" style=text-transform:uppercase title=Categories><span style=color:#2196f3;font-weight:700>| </span>Categories</a>
<a href=/fr/a_propos onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme w3-padding-16 w3-hide-small w3-hide-medium sc-fade" style=text-transform:uppercase title="A propos"><span style=color:#2196f3;font-weight:700>| </span>A propos</a>
<a href=/fr/contacter onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme w3-padding-16 w3-hide-small w3-hide-medium sc-fade" style=text-transform:uppercase title=Contact><span style=color:#2196f3;font-weight:700>| </span>Contact</a><div class="w3-bar-item w3-dropdown-hover w3-hover-theme w3-right w3-hide-small" style=padding-right:8px;padding-top:7px><button class="w3-bar-item w3-theme">FR <img src=media/world.png style=max-width:18px alt="language selector"></button><div class="w3-dropdown-content w3-theme-l5 w3-bar-block w3-card-4" style=top:52px;right:0><a href=https://myprojectcorner.com/connected-temperature-humidity-sensor/ class="w3-bar-item w3-button sc-fade" style=text-align:center>English</a>
<a href=https://myprojectcorner.com/es/connected-temperature-humidity-sensor/ class="w3-bar-item w3-button sc-fade" style=text-align:center>Español</a></div></div></div></div></header><div class="w3-overlay w3-animate-opacity" onclick=w3_close() style=cursor:pointer title="close side menu" id=myOverlay></div><main class=w3-content id=main><section class="w3-container w3-card-4 w3-theme-title w3-center w3-margin" id=pageheader><h1>Capteur de température et d’humidité connecté</h1><hr class=title><h5>Utilisation du MQTT et du Node Red</h5></section><div class="w3-container sc-section sc-mobile"><div class="w3-container sc-sub-section sc-mobile"><div class="w3-container sc-top-section sc-mobile"><a href=d1mini_temp_hum/d1mini-temp-hum11.jpg target=_blank><picture>
<source type=image/webp data-srcset="d1mini_temp_hum/d1mini-temp-hum11.webp 1280w,
        d1mini_temp_hum/d1mini-temp-hum11-960.webp 960w,
        d1mini_temp_hum/d1mini-temp-hum11-640.webp 640w,
        d1mini_temp_hum/d1mini-temp-hum11-320.webp 320w" data-sizes=100w><img alt="capteur de température et d'humidité fini" class="lazy blog-image-padding w3-hover-shadow" data-src=d1mini_temp_hum/d1mini-temp-hum11-1280.jpg data-srcset="d1mini_temp_hum/d1mini-temp-hum11.jpg 1280w,
        d1mini_temp_hum/d1mini-temp-hum11-960.jpg 960w,
        d1mini_temp_hum/d1mini-temp-hum11-640.jpg 640w,
        d1mini_temp_hum/d1mini-temp-hum11-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>Capteur de température et d'humidité fini en fonctionnement</h5></a></div><div class="w3-container sc-multi-section sc-mobile"><div class="w3-panel w3-card-2 w3-leftbar w3-rightbar sc-quote sc-mobile-quote"><p>Un capteur connecté au MQTT avec un affichage LCD pour surveiller les relevés de température et d&rsquo;humidité dans ma maison. J&rsquo;en ai construit trois et les ai placés dans des pièces différentes. Les relevés de température et d&rsquo;humidité sont envoyés par MQTT à mon tableau de bord Node Red sur le Raspberry Pi.</p><p>Bien qu&rsquo;il ne soit pas vraiment nécessaire d&rsquo;avoir un affichage numérique pour un capteur connecté, il est pratique de pouvoir voir la température sans avoir à se connecter au tableau de bord du Node Red.</p></div></div><div class="w3-container sc-multi-end-section sc-mobile"><ul class="w3-ul w3-card sc-partlist sc-mobile"><hr><blockquote><h4 id=pièces-utilisées-pour-construire-lunité><em><strong>Pièces utilisées pour construire l&rsquo;unité</strong></em></h4></blockquote><ul><li>D1 mini</li><li>DHT22 Shield</li><li>Digital readout IC2 KY34-B</li><li>Dupont connectors</li><li>Boîtier imprimé en 3D</li><li>Alimentation électrique 5v</li></ul></ul></div></div></div><div class="w3-container sc-section sc-mobile"><div class="w3-container sc-header-section sc-mobile sc-padding-lr"><header><h2>Première étape</h2><hr class=sub><h5>Conception et impression</h5></header></div><div class="w3-container sc-sub-section sc-mobile"><div class="w3-container sc-top-section sc-mobile"><div class="w3-container sc-text-block-clear sc-mobile sc-padding-lr"><h3 id=modélisation-3d-de-boiter>Modélisation 3D de boiter</h3><p>J&rsquo;ai utilisé Tinkercad pour créer le modèle 3D de mon dessin. C&rsquo;est la première fois que j&rsquo;utilise Tinkercad et je le recommande vivement. Il est très facile à utiliser et produit un bon modèle.</p><p>Les fichiers stl peuvent être téléchargés sur <strong><a style=text-transform:capitalize;color:#2196f3;text-decoration:underline href=https://www.thingiverse.com/thing:3924670 title="Cliquez ici pour visiter Thingiverse">Thingiverse</a></strong>, ou en utilisant le lien ci-dessous</p></div></div><div class="w3-row w3-padding-32 sc-multi-section sc-mobile"><div class="w3_container w3-half w3-padding-large sc-padding-lr"><a href=d1mini_temp_hum/d1mini-temp-hum13.jpg target=_blank><picture>
<source type=image/webp data-srcset="d1mini_temp_hum/d1mini-temp-hum13.webp 1280w,
        d1mini_temp_hum/d1mini-temp-hum13-960.webp 960w,
        d1mini_temp_hum/d1mini-temp-hum13-640.webp 640w,
        d1mini_temp_hum/d1mini-temp-hum13-320.webp 320w" data-sizes=100w><img alt="Modèle 3d de base pour le capteur de température et d'humidité" class="lazy blog-image-padding w3-hover-shadow" data-src=d1mini_temp_hum/d1mini-temp-hum13-1280.jpg data-srcset="d1mini_temp_hum/d1mini-temp-hum13.jpg 1280w,
        d1mini_temp_hum/d1mini-temp-hum13-960.jpg 960w,
        d1mini_temp_hum/d1mini-temp-hum13-640.jpg 640w,
        d1mini_temp_hum/d1mini-temp-hum13-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>Modèle 3d de la base</h5></a></div><div class="w3_container w3-half w3-padding-large sc-padding-lr"><a href=d1mini_temp_hum/d1mini-temp-hum14.jpg target=_blank><picture>
<source type=image/webp data-srcset="d1mini_temp_hum/d1mini-temp-hum14.webp 1280w,
        d1mini_temp_hum/d1mini-temp-hum14-960.webp 960w,
        d1mini_temp_hum/d1mini-temp-hum14-640.webp 640w,
        d1mini_temp_hum/d1mini-temp-hum14-320.webp 320w" data-sizes=100w><img alt="Modèle 3d de couverture pour capteur de température et d'humidité" class="lazy blog-image-padding w3-hover-shadow" data-src=d1mini_temp_hum/d1mini-temp-hum14-1280.jpg data-srcset="d1mini_temp_hum/d1mini-temp-hum14.jpg 1280w,
        d1mini_temp_hum/d1mini-temp-hum14-960.jpg 960w,
        d1mini_temp_hum/d1mini-temp-hum14-640.jpg 640w,
        d1mini_temp_hum/d1mini-temp-hum14-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>Modèle de couverture 3d</h5></a></div></div><div class="w3-container sc-multi-section sc-mobile"><div class="w3-container sc-text-block-clear sc-mobile sc-padding-lr"><hr><h4 id=3d-impression-de-la-boiter>3d Impression de la boiter</h4><p>Le dessin a été imprimé en PLA noir avec une résolution de 0,2 et un remplissage de 20 %. La base a été imprimée avec un support activé pour le trou oblong d&rsquo;alimentation électrique.</p></div></div><div class="w3-container sc-multi-end-section sc-mobile"><a href=d1mini_temp_hum/d1mini-temp-hum01.jpg target=_blank><picture>
<source type=image/webp data-srcset="d1mini_temp_hum/d1mini-temp-hum01.webp 1280w,
        d1mini_temp_hum/d1mini-temp-hum01-960.webp 960w,
        d1mini_temp_hum/d1mini-temp-hum01-640.webp 640w,
        d1mini_temp_hum/d1mini-temp-hum01-320.webp 320w" data-sizes=100w><img alt="Boîtier imprimé en 3d pour le capteur de température et d'humidité" class="lazy blog-image-padding w3-hover-shadow" data-src=d1mini_temp_hum/d1mini-temp-hum01-1280.jpg data-srcset="d1mini_temp_hum/d1mini-temp-hum01.jpg 1280w,
        d1mini_temp_hum/d1mini-temp-hum01-960.jpg 960w,
        d1mini_temp_hum/d1mini-temp-hum01-640.jpg 640w,
        d1mini_temp_hum/d1mini-temp-hum01-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>Boîtier imprimé en 3d pour le capteur de température et d'humidité</h5></a></div></div></div><div class="w3-container sc-section-ad sc-mobile"><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-1748277873952415 data-ad-slot=2611434208 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="w3-container sc-section sc-mobile"><div class="w3-container sc-sub-section sc-mobile"><div class="w3-container sc-header-section sc-mobile sc-padding-lr"><header><h2>Deuxième étape</h2><hr class=sub><h5>Programmation et connexions</h5></header></div></div><div class="w3-container sc-top-section sc-mobile"><div class="w3-container sc-text-block-clear sc-mobile sc-padding-lr"><hr><h4 id=téléchargez-le-code-sur-le-mini-d1>Téléchargez le code sur le mini D1</h4><p>En utilisant le code Arduino ci-dessous, changez les détails de la connexion wifi pour votre propre réseau wifi. Définissez également l&rsquo;adresse IP du Raspberry Pi qui fait tourner le serveur mqtt.</p><p>Vous aurez également besoin des bibliothèques en plus</p><ul><li>ESP8266 support libraries</li><li>Mqtt support</li><li>IC2 Display</li><li>DHT22</li></ul><p>ils peuvent être facilement installés via l&rsquo;option &ldquo;gérer les bibliothèques&rdquo; dans Arduino IDE</p><p>Une fois terminé, vous pouvez compiler et télécharger vers le D1 mini.</p></div></div><div class="w3-container sc-multi-section sc-mobile"><div class="w3-container sc-text-block-pi sc-mobile sc-padding-lr"><div class=highlight><pre style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#007020>#include</span> <span style=color:#007020>&lt;ESP8266WiFi.h&gt;</span><span style=color:#007020>
</span><span style=color:#007020>#include</span> <span style=color:#007020>&lt;PubSubClient.h&gt;</span><span style=color:#007020>
</span><span style=color:#007020>#include</span> <span style=color:#007020>&lt;DHT.h&gt;</span><span style=color:#007020>
</span><span style=color:#007020>#include</span> <span style=color:#007020>&#34;SSD1306.h&#34; // alias for `#include &#34;SSD1306Wire.h&#34;`</span><span style=color:#007020>
</span><span style=color:#007020></span> 
<span style=color:#007020>#define DHTPIN D4     </span><span style=color:#60a0b0;font-style:italic>// what pin the DHT is connected to
</span><span style=color:#60a0b0;font-style:italic></span> 
<span style=color:#60a0b0;font-style:italic>// Initialize the OLED display using Wire library
</span><span style=color:#60a0b0;font-style:italic></span>SSD1306  <span style=color:#06287e>display</span>(<span style=color:#40a070>0x3C</span>, D3, D5); <span style=color:#60a0b0;font-style:italic>// (I2C Address, SCL Pin, SDA Pin)
</span><span style=color:#60a0b0;font-style:italic></span> 
<span style=color:#007020>#define DHTTYPE DHT22   </span><span style=color:#60a0b0;font-style:italic>// DHT 22  (AM2302)
</span><span style=color:#60a0b0;font-style:italic></span><span style=color:#007020;font-weight:700>const</span> <span style=color:#902000>int</span> TEMPERATURE_INTERVAL <span style=color:#666>=</span> <span style=color:#40a070>30</span>;
<span style=color:#902000>unsigned</span> <span style=color:#902000>long</span> last_temperature_sent <span style=color:#666>=</span> <span style=color:#40a070>0</span>;
 
<span style=color:#60a0b0;font-style:italic>// WiFi Connection Details
</span><span style=color:#60a0b0;font-style:italic></span><span style=color:#007020;font-weight:700>const</span> <span style=color:#902000>char</span><span style=color:#666>*</span> ssid <span style=color:#666>=</span> <span style=color:#4070a0>&#34;Your SSID&#34;</span>;
<span style=color:#007020;font-weight:700>const</span> <span style=color:#902000>char</span><span style=color:#666>*</span> password <span style=color:#666>=</span> <span style=color:#4070a0>&#34;Your password&#34;</span>;
 
<span style=color:#60a0b0;font-style:italic>// Raspberry Pi IP address, so it connects to your MQTT broker
</span><span style=color:#60a0b0;font-style:italic></span><span style=color:#007020;font-weight:700>const</span> <span style=color:#902000>char</span><span style=color:#666>*</span> mqtt_server <span style=color:#666>=</span> <span style=color:#4070a0>&#34;IP address of mqtt server&#34;</span>;
 
<span style=color:#60a0b0;font-style:italic>// Change these to suit
</span><span style=color:#60a0b0;font-style:italic></span>WiFiClient wemos_lounge;
PubSubClient <span style=color:#06287e>client</span>(wemos_lounge);
 
<span style=color:#007020;font-weight:700>const</span> <span style=color:#902000>int</span> HUMIDITY_INTERVAL <span style=color:#666>=</span> <span style=color:#40a070>30</span>;
<span style=color:#902000>unsigned</span> <span style=color:#902000>long</span> last_humidity_sent <span style=color:#666>=</span> <span style=color:#40a070>0</span>;
String display_temp;
String display_humid;
 
DHT <span style=color:#06287e>dht</span>(DHTPIN, DHTTYPE);
 
<span style=color:#60a0b0;font-style:italic>// This functions connects your ESP8266 to your router
</span><span style=color:#60a0b0;font-style:italic></span><span style=color:#902000>void</span> <span style=color:#06287e>setup_wifi</span>() {
  delay(<span style=color:#40a070>10</span>);
  <span style=color:#60a0b0;font-style:italic>// We start by connecting to a WiFi network
</span><span style=color:#60a0b0;font-style:italic></span>  Serial.println();
  Serial.print(<span style=color:#4070a0>&#34;Connecting to &#34;</span>);
  Serial.println(ssid);
  WiFi.begin(ssid, password);
  <span style=color:#007020;font-weight:700>while</span> (WiFi.status() <span style=color:#666>!=</span> WL_CONNECTED) {
    delay(<span style=color:#40a070>500</span>);
    Serial.print(<span style=color:#4070a0>&#34;.&#34;</span>);
  }
  Serial.println(<span style=color:#4070a0>&#34;&#34;</span>);
  Serial.print(<span style=color:#4070a0>&#34;WiFi connected - ESP IP address: &#34;</span>);
  Serial.println(WiFi.localIP());
}
 
<span style=color:#60a0b0;font-style:italic>// This functions reconnects your ESP8266 to your MQTT broker
</span><span style=color:#60a0b0;font-style:italic></span><span style=color:#902000>void</span> <span style=color:#06287e>reconnect</span>() {
  <span style=color:#60a0b0;font-style:italic>// Loop until we&#39;re reconnected
</span><span style=color:#60a0b0;font-style:italic></span>  <span style=color:#007020;font-weight:700>while</span> (<span style=color:#666>!</span>client.connected()) {
    Serial.print(<span style=color:#4070a0>&#34;Attempting MQTT connection...&#34;</span>);
    <span style=color:#007020;font-weight:700>if</span> (client.connect(<span style=color:#4070a0>&#34;wemos_lounge&#34;</span>)) {
      Serial.println(<span style=color:#4070a0>&#34;connected&#34;</span>);  
      <span style=color:#60a0b0;font-style:italic>// Subscribe or resubscribe to a topic
</span><span style=color:#60a0b0;font-style:italic></span>      client.subscribe(<span style=color:#4070a0>&#34;heating/temperature_lounge&#34;</span>);
    } <span style=color:#007020;font-weight:700>else</span> {
      Serial.print(<span style=color:#4070a0>&#34;failed, rc=&#34;</span>);
      Serial.print(client.state());
      Serial.println(<span style=color:#4070a0>&#34; try again in 5 seconds&#34;</span>);
      <span style=color:#60a0b0;font-style:italic>// Wait 5 seconds before retrying
</span><span style=color:#60a0b0;font-style:italic></span>      delay(<span style=color:#40a070>5000</span>);
    }
  }
}
 
<span style=color:#902000>void</span> <span style=color:#06287e>setupHandler</span>() {
  <span style=color:#60a0b0;font-style:italic>// Do what you want to prepare your sensor
</span><span style=color:#60a0b0;font-style:italic></span>  display.clear();
}
 
<span style=color:#902000>void</span> <span style=color:#06287e>getSendTemperature</span>() {
  <span style=color:#007020;font-weight:700>if</span> (millis() <span style=color:#666>-</span> last_temperature_sent <span style=color:#666>&gt;=</span> TEMPERATURE_INTERVAL <span style=color:#666>*</span> <span style=color:#40a070>1000UL</span> <span style=color:#666>||</span> last_temperature_sent <span style=color:#666>==</span> <span style=color:#40a070>0</span>) {
    <span style=color:#902000>float</span> temperature <span style=color:#666>=</span> dht.readTemperature(<span style=color:#007020>false</span>);
    <span style=color:#007020;font-weight:700>if</span> (isnan(temperature)) {
      Serial.println(<span style=color:#4070a0>&#34;Failed to read from DHT sensor!&#34;</span>);
      <span style=color:#007020;font-weight:700>return</span>;
    }
<span style=color:#60a0b0;font-style:italic>// May need to offset temperature reading:
</span><span style=color:#60a0b0;font-style:italic>// I found the reading to be 3.1° too high
</span><span style=color:#60a0b0;font-style:italic></span>    display_temp <span style=color:#666>=</span> (temperature<span style=color:#666>-</span><span style=color:#40a070>3.1</span>);
    <span style=color:#902000>int</span> temp <span style=color:#666>=</span> round(temperature<span style=color:#666>-</span><span style=color:#40a070>3.1</span>);
    <span style=color:#902000>char</span> cstr[<span style=color:#40a070>16</span>];
    itoa(temp, cstr, <span style=color:#40a070>10</span>);
    client.publish(<span style=color:#4070a0>&#34;heating/temperature_lounge&#34;</span>,cstr);
    Serial.print(<span style=color:#4070a0>&#34;Temperature: &#34;</span>);
    Serial.print(temperature);
     
    Serial.println(<span style=color:#4070a0>&#34; °C&#34;</span>);
  }
}
 
<span style=color:#902000>void</span> <span style=color:#06287e>getSendHumid</span>() {
  <span style=color:#007020;font-weight:700>if</span> (millis() <span style=color:#666>-</span> last_humidity_sent <span style=color:#666>&gt;=</span> HUMIDITY_INTERVAL <span style=color:#666>*</span> <span style=color:#40a070>1000UL</span> <span style=color:#666>||</span> last_humidity_sent <span style=color:#666>==</span> <span style=color:#40a070>0</span>) {
    <span style=color:#902000>float</span> humidity <span style=color:#666>=</span> dht.readHumidity();
 
    <span style=color:#007020;font-weight:700>if</span> (isnan(humidity)) {
      Serial.println(<span style=color:#4070a0>&#34;Failed to read from DHT sensor!&#34;</span>);
      <span style=color:#007020;font-weight:700>return</span>;
    }
    display_humid <span style=color:#666>=</span> humidity;
    <span style=color:#902000>int</span> humid <span style=color:#666>=</span> round(humidity);
    <span style=color:#902000>char</span> cstr[<span style=color:#40a070>16</span>];
    itoa(humid, cstr, <span style=color:#40a070>10</span>);
    client.publish(<span style=color:#4070a0>&#34;heating/humidity_lounge&#34;</span>, cstr);
    Serial.print(<span style=color:#4070a0>&#34;Humidity: &#34;</span>);
    Serial.print(humidity);
    Serial.println(<span style=color:#4070a0>&#34; %&#34;</span>);
  } 
 }
 
<span style=color:#902000>void</span> <span style=color:#06287e>displayData</span>() {
    display.clear();
    display.setTextAlignment(TEXT_ALIGN_CENTER);
    display.setFont(ArialMT_Plain_24);
    display.drawString(<span style=color:#40a070>66</span>, <span style=color:#40a070>5</span>, display_temp <span style=color:#666>+</span> <span style=color:#4070a0>&#34;C&#34;</span>);
    display.drawString(<span style=color:#40a070>66</span>, <span style=color:#40a070>35</span>, display_humid <span style=color:#666>+</span> <span style=color:#4070a0>&#34;%&#34;</span>);
    display.display();
}
 
<span style=color:#902000>void</span> <span style=color:#06287e>setup</span>() {
 
  Serial.begin(<span style=color:#40a070>115200</span>);
  setup_wifi();
  client.setServer(mqtt_server, <span style=color:#40a070>1883</span>);
  <span style=color:#60a0b0;font-style:italic>// Initialising the display.
</span><span style=color:#60a0b0;font-style:italic></span>  WiFi.mode(WIFI_STA);
  display.init();
  display.clear();
  display.flipScreenVertically();
  display.setTextAlignment(TEXT_ALIGN_CENTER);
  display.display();
}
 
<span style=color:#902000>void</span> <span style=color:#06287e>loop</span>() {
  <span style=color:#60a0b0;font-style:italic>//connect wifi if not connected
</span><span style=color:#60a0b0;font-style:italic></span>  <span style=color:#007020;font-weight:700>if</span> (WiFi.status() <span style=color:#666>!=</span> WL_CONNECTED) {
    delay(<span style=color:#40a070>1</span>);
    setup_wifi();
    <span style=color:#007020;font-weight:700>return</span>;
}
  <span style=color:#007020;font-weight:700>if</span> (<span style=color:#666>!</span>client.connected()) {
    reconnect();
  }
  <span style=color:#007020;font-weight:700>if</span>(<span style=color:#666>!</span>client.loop())
    client.connect(<span style=color:#4070a0>&#34;wemos_lounge&#34;</span>);
  getSendTemperature();
  getSendHumid(); 
  displayData();
  delay(<span style=color:#40a070>2000</span>);
}
</code></pre></div></div></div><div class="w3-container sc-multi-section sc-mobile"><div class="w3-container sc-text-block-clear sc-mobile sc-padding-lr"><hr><h4 id=assemblage-des-composants>Assemblage des composants</h4><p>J&rsquo;ai acheté le D1 mini et le chapeau DHT22 chez AliExpress. C&rsquo;est une source bon marché pour ce type de composants (si vous n&rsquo;êtes pas très pressé, la livraison peut prendre jusqu&rsquo;à 3 semaines).</p></div></div><div class="w3-row w3-padding-32 sc-multi-section sc-mobile"><div class="w3_container w3-half w3-padding-large sc-padding-lr"><a href=d1mini_temp_hum/d1mini-temp-hum12.jpg target=_blank><picture>
<source type=image/webp data-srcset="d1mini_temp_hum/d1mini-temp-hum12.webp 1280w,
        d1mini_temp_hum/d1mini-temp-hum12-960.webp 960w,
        d1mini_temp_hum/d1mini-temp-hum12-640.webp 640w,
        d1mini_temp_hum/d1mini-temp-hum12-320.webp 320w" data-sizes=100w><img alt="souder des blocs de broches à d1 mini" class="lazy blog-image-padding w3-hover-shadow" data-src=d1mini_temp_hum/d1mini-temp-hum12-1280.jpg data-srcset="d1mini_temp_hum/d1mini-temp-hum12.jpg 1280w,
        d1mini_temp_hum/d1mini-temp-hum12-960.jpg 960w,
        d1mini_temp_hum/d1mini-temp-hum12-640.jpg 640w,
        d1mini_temp_hum/d1mini-temp-hum12-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>Souder le bloc à broche femelle au shield du DHT22 et le bloc mâle au mini D1</h5></a></div><div class="w3_container w3-half w3-padding-large sc-padding-lr"><a href=d1mini_temp_hum/d1mini-temp-hum04.jpg target=_blank><picture>
<source type=image/webp data-srcset="d1mini_temp_hum/d1mini-temp-hum04.webp 1280w,
        d1mini_temp_hum/d1mini-temp-hum04-960.webp 960w,
        d1mini_temp_hum/d1mini-temp-hum04-640.webp 640w,
        d1mini_temp_hum/d1mini-temp-hum04-320.webp 320w" data-sizes=100w><img alt="connexion de l'écran à d1 mini" class="lazy blog-image-padding w3-hover-shadow" data-src=d1mini_temp_hum/d1mini-temp-hum04-1280.jpg data-srcset="d1mini_temp_hum/d1mini-temp-hum04.jpg 1280w,
        d1mini_temp_hum/d1mini-temp-hum04-960.jpg 960w,
        d1mini_temp_hum/d1mini-temp-hum04-640.jpg 640w,
        d1mini_temp_hum/d1mini-temp-hum04-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>Raccourcir et souder les quatre fils DuPont pour connecter l'écran</h5></a></div></div><div class="w3-container sc-multi-section sc-mobile"><ul class="w3-ul w3-card sc-partlist sc-mobile"><hr><blockquote><h3 id=connexions-de-lécran-au-d1-mini>Connexions de l&rsquo;écran au D1 mini</h3></blockquote><ul><li>Fil rouge VCC à 3,3v</li><li>Fil noir GND à G</li><li>Fil blanc SCL à D5</li><li>Fil violet SDA à D3</li></ul></ul></div><div class="w3-container sc-multi-end-section sc-mobile"><a href=d1mini_temp_hum/d1mini-temp-hum02.jpg target=_blank><picture>
<source type=image/webp data-srcset="d1mini_temp_hum/d1mini-temp-hum02.webp 1280w,
        d1mini_temp_hum/d1mini-temp-hum02-960.webp 960w,
        d1mini_temp_hum/d1mini-temp-hum02-640.webp 640w,
        d1mini_temp_hum/d1mini-temp-hum02-320.webp 320w" data-sizes=100w><img alt="mise sous tension du capteur de température et d'humidité" class="lazy blog-image-padding w3-hover-shadow" data-src=d1mini_temp_hum/d1mini-temp-hum02-1280.jpg data-srcset="d1mini_temp_hum/d1mini-temp-hum02.jpg 1280w,
        d1mini_temp_hum/d1mini-temp-hum02-960.jpg 960w,
        d1mini_temp_hum/d1mini-temp-hum02-640.jpg 640w,
        d1mini_temp_hum/d1mini-temp-hum02-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>Mise sous tension du capteur de température et d'humidité</h5></a></div></div><div class="w3-container sc-section-ad sc-mobile"><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-1748277873952415 data-ad-slot=2611434208 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="w3-container sc-section sc-mobile"><div class="w3-container sc-sub-section sc-mobile"><div class="w3-container sc-header-section sc-mobile sc-padding-lr"><header><h2>Troisième étape</h2><hr class=sub><h5>Assemblage des composants dans le boîtier</h5></header></div></div><div class="w3-row w3-padding-32 sc-top-section sc-mobile"><div class="w3_container w3-half w3-left-align w3-padding-large sc-padding-lr"><p>J&rsquo;ai utilisé mon pistolet à colle chaude pour assembler le capteur de température et d&rsquo;humidité connecté.</p><p>Commencez par coller le présentoir. Il y a des épingles de positionnement dans l&rsquo;impression (mais elles ne s&rsquo;alignent pas toujours très bien)</p></div><div class="w3_container w3-half w3-padding-large sc-padding-lr"><a href=d1mini_temp_hum/d1mini-temp-hum06.jpg target=_blank><picture>
<source type=image/webp data-srcset="d1mini_temp_hum/d1mini-temp-hum06.webp 1280w,
        d1mini_temp_hum/d1mini-temp-hum06-960.webp 960w,
        d1mini_temp_hum/d1mini-temp-hum06-640.webp 640w,
        d1mini_temp_hum/d1mini-temp-hum06-320.webp 320w" data-sizes=100w><img alt="Fixation de l'écran lcd" class="lazy blog-image-padding w3-hover-shadow" data-src=d1mini_temp_hum/d1mini-temp-hum06-1280.jpg data-srcset="d1mini_temp_hum/d1mini-temp-hum06.jpg 1280w,
        d1mini_temp_hum/d1mini-temp-hum06-960.jpg 960w,
        d1mini_temp_hum/d1mini-temp-hum06-640.jpg 640w,
        d1mini_temp_hum/d1mini-temp-hum06-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>Coller à chaud le ecran</h5></a></div></div><div class="w3-container sc-multi-section sc-mobile"><div class="w3-container sc-text-block-clear sc-mobile sc-padding-lr"><hr><h4 id=il-est-nécessaire-de-couper-la-languette-du-capteur-dht22-pour-lui-permettre-de-sinsérer-dans-le-boîtier>Il est nécessaire de couper la languette du capteur DHT22 pour lui permettre de s&rsquo;insérer dans le boîtier</h4><hr><p>Insérez ensuite l&rsquo;ensemble D1 mini et DHT22, en veillant à utiliser un peu de colle chaude pour assurer un espace entre le bouclier du DHT22 et l&rsquo;écran.</p></div></div><div class="w3-row w3-padding-32 sc-multi-section sc-mobile"><div class="w3_container w3-third w3-padding-large sc-padding-lr"><a href=d1mini_temp_hum/d1mini-temp-hum07.jpg target=_blank><picture>
<source type=image/webp data-srcset="d1mini_temp_hum/d1mini-temp-hum07.webp 1280w,
        d1mini_temp_hum/d1mini-temp-hum07-960.webp 960w,
        d1mini_temp_hum/d1mini-temp-hum07-640.webp 640w,
        d1mini_temp_hum/d1mini-temp-hum07-320.webp 320w" data-sizes=100w><img alt="Assemblage des éléments de température et d'humidité dans le boîtier" class="lazy blog-image-padding w3-hover-shadow" data-src=d1mini_temp_hum/d1mini-temp-hum07-1280.jpg data-srcset="d1mini_temp_hum/d1mini-temp-hum07.jpg 1280w,
        d1mini_temp_hum/d1mini-temp-hum07-960.jpg 960w,
        d1mini_temp_hum/d1mini-temp-hum07-640.jpg 640w,
        d1mini_temp_hum/d1mini-temp-hum07-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center></h5></a></div><div class="w3_container w3-third w3-padding-large sc-padding-lr"><a href=d1mini_temp_hum/d1mini-temp-hum08.jpg target=_blank><picture>
<source type=image/webp data-srcset="d1mini_temp_hum/d1mini-temp-hum08.webp 1280w,
        d1mini_temp_hum/d1mini-temp-hum08-960.webp 960w,
        d1mini_temp_hum/d1mini-temp-hum08-640.webp 640w,
        d1mini_temp_hum/d1mini-temp-hum08-320.webp 320w" data-sizes=100w><img alt="Assemblage des éléments de température et d'humidité avec de la colle chaude" class="lazy blog-image-padding w3-hover-shadow" data-src=d1mini_temp_hum/d1mini-temp-hum08-1280.jpg data-srcset="d1mini_temp_hum/d1mini-temp-hum08.jpg 1280w,
        d1mini_temp_hum/d1mini-temp-hum08-960.jpg 960w,
        d1mini_temp_hum/d1mini-temp-hum08-640.jpg 640w,
        d1mini_temp_hum/d1mini-temp-hum08-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center></h5></a></div><div class="w3_container w3-third w3-padding-large sc-padding-lr"><a href=d1mini_temp_hum/d1mini-temp-hum09.jpg target=_blank><picture>
<source type=image/webp data-srcset="d1mini_temp_hum/d1mini-temp-hum09.webp 1280w,
        d1mini_temp_hum/d1mini-temp-hum09-960.webp 960w,
        d1mini_temp_hum/d1mini-temp-hum09-640.webp 640w,
        d1mini_temp_hum/d1mini-temp-hum09-320.webp 320w" data-sizes=100w><img alt="les composantes de la température et de l'humidité dans le boîtier" class="lazy blog-image-padding w3-hover-shadow" data-src=d1mini_temp_hum/d1mini-temp-hum09-1280.jpg data-srcset="d1mini_temp_hum/d1mini-temp-hum09.jpg 1280w,
        d1mini_temp_hum/d1mini-temp-hum09-960.jpg 960w,
        d1mini_temp_hum/d1mini-temp-hum09-640.jpg 640w,
        d1mini_temp_hum/d1mini-temp-hum09-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center></h5></a></div></div><div class="w3-container sc-multi-end-section sc-mobile"><a href=d1mini_temp_hum/d1mini-temp-hum10.jpg target=_blank><picture>
<source type=image/webp data-srcset="d1mini_temp_hum/d1mini-temp-hum10.webp 1280w,
        d1mini_temp_hum/d1mini-temp-hum10-960.webp 960w,
        d1mini_temp_hum/d1mini-temp-hum10-640.webp 640w,
        d1mini_temp_hum/d1mini-temp-hum10-320.webp 320w" data-sizes=100w><img alt="la mise sous tension du capteur de température et d'humidité fini" class="lazy blog-image-padding w3-hover-shadow" data-src=d1mini_temp_hum/d1mini-temp-hum10-1280.jpg data-srcset="d1mini_temp_hum/d1mini-temp-hum10.jpg 1280w,
        d1mini_temp_hum/d1mini-temp-hum10-960.jpg 960w,
        d1mini_temp_hum/d1mini-temp-hum10-640.jpg 640w,
        d1mini_temp_hum/d1mini-temp-hum10-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>L'ensemble fini prêt à être fermé et mis en place</h5></a></div></div><div class="w3-container sc-section sc-mobile"><div class="w3-container sc-header-section sc-mobile sc-padding-lr"><header><h2>Utilisation du capteur de température et d'humidité connecté</h2><hr class=sub><h5>Tableau de bord du Node Red</h5></header></div><div class="w3-container sc-sub-section sc-mobile"><div class="w3-container sc-top-section sc-mobile"><div class="w3-panel w3-card-2 w3-leftbar w3-rightbar sc-quote sc-mobile-quote"><p>Actuellement, je ne les utilise que pour avoir une idée de la température et de l&rsquo;humidité dans toute la maison, le but étant de les utiliser à terme pour ouvrir et fermer les circuits de chauffage au sol.</p></div></div><div class="w3-container sc-multi-end-section sc-mobile"><a href=d1mini_temp_hum/d1-mini-nodered.jpg target=_blank><picture>
<source type=image/webp data-srcset="d1mini_temp_hum/d1-mini-nodered.webp 1024w,
        d1mini_temp_hum/d1-mini-nodered-768.webp 768w,
        d1mini_temp_hum/d1-mini-nodered-512.webp 512w,
        d1mini_temp_hum/d1-mini-nodered-256.webp 256w" data-sizes=100w><img alt="node red output pour les capteurs de température et d'humidité" class="lazy blog-image-padding w3-hover-shadow" data-src=d1mini_temp_hum/d1-mini-nodered-1024.jpg data-srcset="d1mini_temp_hum/d1-mini-nodered.jpg 1024w,
        d1mini_temp_hum/d1-mini-nodered-768.jpg 768w,
        d1mini_temp_hum/d1-mini-nodered-512.jpg 512w,
        d1mini_temp_hum/d1-mini-nodered-256.jpg 256w" data-sizes=100w></picture><h5 class=w3-center>Capture d'écran du tableau de bord du Node Red</h5></a></div></div></div><div class="w3-container sc-section-ad sc-mobile"><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-1748277873952415 data-ad-slot=2611434208 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div></main><footer class="w3-container w3-theme-d2 w3-padding-16 w3-margin-top w3-center w3-card-4" id=myfooter><div><span class="w3-theme-d2 w3-hover-text-theme w3-margin-right" title="Page d'accueil"><a href=/fr>Page d'accueil</a></span>
<span class="w3-theme-d2 w3-hover-text-theme w3-margin-right" title="Politique de confidentialité"><a href=/fr/politique-de-confidentialite>Politique de confidentialité</a></span><div class="w3-center sc-padding-lr"><p><span class="w3-theme-d2 w3-hover-text-theme">&copy; 2020<a href=/fr/capteur-de-temperature-et-humidite-connecte/> My Project Corner</a></span></p></div></footer><script>function w3_open(){document.getElementById("mySidebar").style.display="block";document.getElementById("myOverlay").style.display="block";}
function w3_close(){document.getElementById("mySidebar").style.display="none";document.getElementById("myOverlay").style.display="none";}</script><script>(function(){if(!localStorage.getItem('cookieconsent')){document.body.innerHTML+='\
          <div class="cookieconsent" style="position:fixed;padding:20px;left:0;bottom:0;background-color:darkslategrey;color:#FFF;text-align:center;width:100%;z-index:99999;">\
            Ce site utilise des cookies. En continuant à utiliser ce site, vous acceptez leur utilisation. \
              <a href="#" class="w3-button w3-round-xxlarge w3-theme-l5 w3-margin-left w3-animate-zoom"> OK</a>\
          </div>\
          ';document.querySelector('.cookieconsent a').onclick=function(e){e.preventDefault();document.querySelector('.cookieconsent').style.display='none';localStorage.setItem('cookieconsent',true);};}})();</script><script>var lazyLoadInstance=new LazyLoad({elements_selector:".lazy"});</script></body></html>