<!doctype html><html lang=en><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140425106-2"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-140425106-2');</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Making A DIY Sunrise Alarm Lamp | My Project Corner</title><meta name=description content="This is my sunrise lamp build, I wanted to find out if a sunrise lamp could really make it easier to get up on dark winter mornings. Not wanting to&mldr;"><link rel=canonical href=https://myprojectcorner.com/making-a-diy-sunrise-lamp/><base href=/><link rel=stylesheet href=https://myprojectcorner.com/css/styles.min.css><link rel=icon href=media/logo.png type=image/x-icon><script src=js/lazyload.min.js></script><script data-ad-client=ca-pub-1748277873952415 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head><body><header><nav class="w3-sidebar w3-bar-block w3-opacity-min w3-theme w3-animate-right w3-top w3-text-theme w3-large" style=z-index:3;width:250px;font-weight:700;display:none;right:0 id=mySidebar><a href=javascript:void(0) onclick=w3_close() class="w3-bar-item w3-button w3-animate-bottom w3-theme-d2 w3-xlarge sc-fade" style=text-align:right title=close>X</a>
<a href=/ onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme-l5 w3-padding-16 sc-fade" style=text-transform:uppercase title=Homepage>Homepage</a>
<a href=/projects onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme-l5 w3-padding-16 sc-fade" style=text-transform:uppercase title=Projects>Projects</a>
<a href=/categories/ onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme-l5 w3-padding-16 sc-fade" style=text-transform:uppercase title=Categories>Categories</a>
<a href=/about onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme-l5 w3-padding-16 sc-fade" style=text-transform:uppercase title=About>About</a>
<a href=/contact onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme-l5 w3-padding-16 sc-fade" style=text-transform:uppercase title=Contact>Contact</a><div class="w3-dropdown-hover w3-bar-item w3-center w3-theme-d5 w3-padding-16 w3-hide-medium w3-hide-large"><span style=padding-right:10px>English</span><img src=media/world.png style=max-width:24px alt="language selector"></span><div class="w3-bar-block w3-dropdown-content w3-card-4" style=right:0;top:50px><a href=https://myprojectcorner.com/es/lampara-de-alarma-del-amanecer-diy/ class="w3-bar-item w3-button sc-fade" style=text-align:center>Español</a>
<a href=https://myprojectcorner.com/fr/ma-lampe-du-lever-du-soleil/ class="w3-bar-item w3-button sc-fade" style=text-align:center>Français</a></div></div></nav><div class="w3-top w3-theme"><div class=w3-bar><a href=javascript:void(0) class="w3-button w3-right w3-round w3-theme-action w3-xlarge w3-hide-large" onclick=w3_open()>☰</a>
<a href=index.html class=w3-bar-item><img src=media/logo.png style=max-height:36px alt="my project corner logo"></a>
<a href=index.html class="w3-bar-item w3-theme sc-header">My Project Corner</a>
<a href=/ onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme w3-padding-16 w3-hide-small w3-hide-medium sc-fade" style=text-transform:uppercase title=Homepage><span style=color:#2196f3;font-weight:700>| </span>Homepage</a>
<a href=/projects onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme w3-padding-16 w3-hide-small w3-hide-medium sc-fade" style=text-transform:uppercase title=Projects><span style=color:#2196f3;font-weight:700>| </span>Projects</a>
<a href=/categories/ onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme w3-padding-16 w3-hide-small w3-hide-medium sc-fade" style=text-transform:uppercase title=Categories><span style=color:#2196f3;font-weight:700>| </span>Categories</a>
<a href=/about onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme w3-padding-16 w3-hide-small w3-hide-medium sc-fade" style=text-transform:uppercase title=About><span style=color:#2196f3;font-weight:700>| </span>About</a>
<a href=/contact onclick=w3_close() class="w3-bar-item w3-button w3-center w3-theme w3-padding-16 w3-hide-small w3-hide-medium sc-fade" style=text-transform:uppercase title=Contact><span style=color:#2196f3;font-weight:700>| </span>Contact</a><div class="w3-bar-item w3-dropdown-hover w3-hover-theme w3-right w3-hide-small" style=padding-right:8px;padding-top:7px><button class="w3-bar-item w3-theme">EN <img src=media/world.png style=max-width:18px alt="language selector"></button><div class="w3-dropdown-content w3-theme-l5 w3-bar-block w3-card-4" style=top:52px;right:0><a href=https://myprojectcorner.com/es/lampara-de-alarma-del-amanecer-diy/ class="w3-bar-item w3-button sc-fade" style=text-align:center>Español</a>
<a href=https://myprojectcorner.com/fr/ma-lampe-du-lever-du-soleil/ class="w3-bar-item w3-button sc-fade" style=text-align:center>Français</a></div></div></div></div></header><div class="w3-overlay w3-animate-opacity" onclick=w3_close() style=cursor:pointer title="close side menu" id=myOverlay></div><main class=w3-content id=main><section class="w3-container w3-card-4 w3-theme-title w3-center w3-margin" id=pageheader><h1>Making A DIY Sunrise Alarm Lamp</h1><hr class=title><h5>A gentle way to wake up on dark winter mornings</h5></section><div class="w3-container sc-section sc-mobile"><div class="w3-container sc-sub-section sc-mobile"><div class="w3-container sc-top-section sc-mobile"><a href=sunrise_lamp/sunrise-lamp07.jpg target=_blank><picture>
<source type=image/webp data-srcset="sunrise_lamp/sunrise-lamp07.webp 1278w,
        sunrise_lamp/sunrise-lamp07-959.webp 959w,
        sunrise_lamp/sunrise-lamp07-639.webp 639w,
        sunrise_lamp/sunrise-lamp07-320.webp 320w" data-sizes=100w><img alt="Finished Sunrise Alarm Lamp" class="lazy blog-image-padding w3-hover-shadow" data-src=sunrise_lamp/sunrise-lamp07-1278.jpg data-srcset="sunrise_lamp/sunrise-lamp07.jpg 1278w,
        sunrise_lamp/sunrise-lamp07-959.jpg 959w,
        sunrise_lamp/sunrise-lamp07-639.jpg 639w,
        sunrise_lamp/sunrise-lamp07-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>Finished Sunrise Alarm Lamp</h5></a></div><div class="w3-container sc-multi-section sc-mobile"><div class="w3-panel w3-card-2 w3-leftbar w3-rightbar sc-quote sc-mobile-quote"><p>This is my sunrise lamp build, I wanted to find out if a sunrise lamp could really make it easier to get up on dark winter mornings. Not wanting to spend the 60+ euros on a ready made lamp (and because I like to make stuff), I came up with this design.</p><p>The idea is that the light stimulates you into waking up, exactly as you would on a summer’s morning, feeling relaxed and fresh, without the need for an alarm.</p></div></div><div class="w3-container sc-multi-end-section sc-mobile"><div class="w3-container sc-text-block-clear sc-mobile sc-padding-lr"><p>It is built around an Ikea Fado table lamp and dimmable led bulb, using a 3d printed base to house the electronics. The final unit will be controlled through my Raspberry Pi Node Red dashboard.</p></div></div></div></div><div class="w3-container sc-section-ad sc-mobile"><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-1748277873952415 data-ad-slot=2611434208 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="w3-container sc-section sc-mobile"><div class="w3-container sc-sub-section sc-mobile"><div class="w3-container sc-top-section sc-mobile"><ul class="w3-ul w3-card sc-partlist sc-mobile"><hr><blockquote><h4 id=parts-required-for-the-sunrise-lamp><em><strong>Parts Required for the Sunrise Lamp</strong></em></h4></blockquote><ul><li><p>Fado Lamp - Ikea</p></li><li><p>Dimmable LED Bulb - Ikea</p></li><li><p>WeMos D1 mini</p></li><li><p>Hi-Link 220v AC - 5v DC</p></li><li><p>RobotDyn PWM Dimmer</p></li><li><p>Dupont Connectors</p></li><li><p>The 3D Printed Base</p></li></ul></ul></div><div class="w3-row w3-padding-32 sc-multi-section sc-mobile"><div class="w3_container w3-third w3-padding-large sc-padding-lr"><a href=sunrise_lamp/sunrise-lamp12.jpg target=_blank><picture>
<source type=image/webp data-srcset="sunrise_lamp/sunrise-lamp12.webp 1278w,
        sunrise_lamp/sunrise-lamp12-959.webp 959w,
        sunrise_lamp/sunrise-lamp12-639.webp 639w,
        sunrise_lamp/sunrise-lamp12-320.webp 320w" data-sizes=100w><img alt="Fado Lamp From Ikea" class="lazy blog-image-padding w3-hover-shadow" data-src=sunrise_lamp/sunrise-lamp12-1278.jpg data-srcset="sunrise_lamp/sunrise-lamp12.jpg 1278w,
        sunrise_lamp/sunrise-lamp12-959.jpg 959w,
        sunrise_lamp/sunrise-lamp12-639.jpg 639w,
        sunrise_lamp/sunrise-lamp12-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>Fado Lamp From Ikea</h5></a></div><div class="w3_container w3-third w3-padding-large sc-padding-lr"><a href=sunrise_lamp/sunrise-lamp02.jpg target=_blank><picture>
<source type=image/webp data-srcset="sunrise_lamp/sunrise-lamp02.webp 1278w,
        sunrise_lamp/sunrise-lamp02-959.webp 959w,
        sunrise_lamp/sunrise-lamp02-639.webp 639w,
        sunrise_lamp/sunrise-lamp02-320.webp 320w" data-sizes=100w><img alt="LED Bulb From Ikea" class="lazy blog-image-padding w3-hover-shadow" data-src=sunrise_lamp/sunrise-lamp02-1278.jpg data-srcset="sunrise_lamp/sunrise-lamp02.jpg 1278w,
        sunrise_lamp/sunrise-lamp02-959.jpg 959w,
        sunrise_lamp/sunrise-lamp02-639.jpg 639w,
        sunrise_lamp/sunrise-lamp02-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>LED Bulb From Ikea</h5></a></div><div class="w3_container w3-third w3-padding-large sc-padding-lr"><a href=sunrise_lamp/sunrise-lamp05.jpg target=_blank><picture>
<source type=image/webp data-srcset="sunrise_lamp/sunrise-lamp05.webp 1278w,
        sunrise_lamp/sunrise-lamp05-959.webp 959w,
        sunrise_lamp/sunrise-lamp05-639.webp 639w,
        sunrise_lamp/sunrise-lamp05-320.webp 320w" data-sizes=100w><img alt="WeMos D1 mini" class="lazy blog-image-padding w3-hover-shadow" data-src=sunrise_lamp/sunrise-lamp05-1278.jpg data-srcset="sunrise_lamp/sunrise-lamp05.jpg 1278w,
        sunrise_lamp/sunrise-lamp05-959.jpg 959w,
        sunrise_lamp/sunrise-lamp05-639.jpg 639w,
        sunrise_lamp/sunrise-lamp05-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>WeMos D1 mini</h5></a></div></div><div class="w3-row w3-padding-32 sc-multi-section sc-mobile"><div class="w3_container w3-third w3-padding-large sc-padding-lr"><a href=sunrise_lamp/sunrise-lamp01.jpg target=_blank><picture>
<source type=image/webp data-srcset="sunrise_lamp/sunrise-lamp01.webp 1278w,
        sunrise_lamp/sunrise-lamp01-959.webp 959w,
        sunrise_lamp/sunrise-lamp01-639.webp 639w,
        sunrise_lamp/sunrise-lamp01-320.webp 320w" data-sizes=100w><img alt="Hi-Link 220v AC - 5v DC" class="lazy blog-image-padding w3-hover-shadow" data-src=sunrise_lamp/sunrise-lamp01-1278.jpg data-srcset="sunrise_lamp/sunrise-lamp01.jpg 1278w,
        sunrise_lamp/sunrise-lamp01-959.jpg 959w,
        sunrise_lamp/sunrise-lamp01-639.jpg 639w,
        sunrise_lamp/sunrise-lamp01-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>Hi-Link 220v AC - 5v DC</h5></a></div><div class="w3_container w3-third w3-padding-large sc-padding-lr"><a href=sunrise_lamp/sunrise-lamp10.jpg target=_blank><picture>
<source type=image/webp data-srcset="sunrise_lamp/sunrise-lamp10.webp 1278w,
        sunrise_lamp/sunrise-lamp10-959.webp 959w,
        sunrise_lamp/sunrise-lamp10-639.webp 639w,
        sunrise_lamp/sunrise-lamp10-320.webp 320w" data-sizes=100w><img alt="RobotDyn PWM Dimmer" class="lazy blog-image-padding w3-hover-shadow" data-src=sunrise_lamp/sunrise-lamp10-1278.jpg data-srcset="sunrise_lamp/sunrise-lamp10.jpg 1278w,
        sunrise_lamp/sunrise-lamp10-959.jpg 959w,
        sunrise_lamp/sunrise-lamp10-639.jpg 639w,
        sunrise_lamp/sunrise-lamp10-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>RobotDyn PWM Dimmer</h5></a></div><div class="w3_container w3-third w3-padding-large sc-padding-lr"><a href=sunrise_lamp/sunrise-lamp03.jpg target=_blank><picture>
<source type=image/webp data-srcset="sunrise_lamp/sunrise-lamp03.webp 1278w,
        sunrise_lamp/sunrise-lamp03-959.webp 959w,
        sunrise_lamp/sunrise-lamp03-639.webp 639w,
        sunrise_lamp/sunrise-lamp03-320.webp 320w" data-sizes=100w><img alt="Sunrise lamp 3D Printed Base" class="lazy blog-image-padding w3-hover-shadow" data-src=sunrise_lamp/sunrise-lamp03-1278.jpg data-srcset="sunrise_lamp/sunrise-lamp03.jpg 1278w,
        sunrise_lamp/sunrise-lamp03-959.jpg 959w,
        sunrise_lamp/sunrise-lamp03-639.jpg 639w,
        sunrise_lamp/sunrise-lamp03-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>3D Printed Base</h5></a></div></div><div class="w3-container sc-multi-end-section sc-mobile"><div class="w3-panel w3-card-2 w3-leftbar w3-rightbar sc-quote sc-mobile-quote"><p>Excluding the 3d print the total cost came in at under 25€</p></div></div></div></div><div class="w3-container sc-section sc-mobile"><div class="w3-container sc-header-section sc-mobile sc-padding-lr"><header><h2>Design and Printing</h2><hr class=sub><h5>3d Printed Base for Sunrise Lamp</h5></header></div><div class="w3-container sc-sub-section sc-mobile"><div class="w3-row w3-padding-32 sc-top-section sc-mobile"><div class="w3_container w3-half w3-left-align w3-padding-large sc-padding-lr"><p>I started by using SketchUp to design a base that would hold the electronics to control the lamp.</p><p>The design can be downloaded from <strong><a style=text-transform:capitalize;color:#2196f3;text-decoration:underline href=https://www.thingiverse.com/thing:4102831>Thingiverse</a></strong></p><p>I printed with 20% infill and 3 layers for base and walls. This makes it a nice solid print. The print time is upwards of 12 hrs using the settings that I used.</p></div><div class="w3_container w3-half w3-padding-large sc-padding-lr"><a href=sunrise_lamp/sunrise-lamp04.jpg target=_blank><picture>
<source type=image/webp data-srcset="sunrise_lamp/sunrise-lamp04.webp 1278w,
        sunrise_lamp/sunrise-lamp04-959.webp 959w,
        sunrise_lamp/sunrise-lamp04-639.webp 639w,
        sunrise_lamp/sunrise-lamp04-320.webp 320w" data-sizes=100w><img alt="3d printed base for sunrise lamp ready for assembly" class="lazy blog-image-padding w3-hover-shadow" data-src=sunrise_lamp/sunrise-lamp04-1278.jpg data-srcset="sunrise_lamp/sunrise-lamp04.jpg 1278w,
        sunrise_lamp/sunrise-lamp04-959.jpg 959w,
        sunrise_lamp/sunrise-lamp04-639.jpg 639w,
        sunrise_lamp/sunrise-lamp04-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center></h5></a></div></div><div class="w3-row w3-padding-32 sc-multi-end-section sc-mobile"><div class="w3_container w3-half w3-left-align w3-padding-large sc-padding-lr"><p>The lamp doesn&rsquo;t sit fully in the printed base because of the taper on the base of the lamp. This was not intended but it&rsquo;s not extremely visible and the 4 small gaps allow for heat dispersal (not that it gets very hot at all).</p></div><div class="w3_container w3-half w3-padding-large sc-padding-lr"><a href=sunrise_lamp/sunrise-lamp15.jpg target=_blank><picture>
<source type=image/webp data-srcset="sunrise_lamp/sunrise-lamp15.webp 1278w,
        sunrise_lamp/sunrise-lamp15-959.webp 959w,
        sunrise_lamp/sunrise-lamp15-639.webp 639w,
        sunrise_lamp/sunrise-lamp15-320.webp 320w" data-sizes=100w><img alt="showing gaps in sunrise lamp assembly" class="lazy blog-image-padding w3-hover-shadow" data-src=sunrise_lamp/sunrise-lamp15-1278.jpg data-srcset="sunrise_lamp/sunrise-lamp15.jpg 1278w,
        sunrise_lamp/sunrise-lamp15-959.jpg 959w,
        sunrise_lamp/sunrise-lamp15-639.jpg 639w,
        sunrise_lamp/sunrise-lamp15-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center></h5></a></div></div></div></div><div class="w3-container sc-section-ad sc-mobile"><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-1748277873952415 data-ad-slot=2611434208 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="w3-container sc-section sc-mobile"><div class="w3-container sc-header-section sc-mobile sc-padding-lr"><header><h2>Preparation and build</h2><hr class=sub><h5>Adding the Electronics to the Sunrise Lamp Base</h5></header></div><div class="w3-container sc-sub-section sc-mobile"><div class="w3-row w3-padding-32 sc-top-section sc-mobile"><div class="w3_container w3-half w3-left-align w3-padding-large sc-padding-lr"><h4 id=cut-down-the-dimmer-heatsink>Cut down the dimmer heatsink</h4><p>It is necessary to reduce the height of the heatsink on the RobotDyn PWM dimmer to clear the base of the lamp.</p><p>Using a metal saw I removed 10mm from the top of the heatsink</p></div><div class="w3_container w3-half w3-padding-large sc-padding-lr"><a href=sunrise_lamp/sunrise-lamp11.jpg target=_blank><picture>
<source type=image/webp data-srcset="sunrise_lamp/sunrise-lamp11.webp 1278w,
        sunrise_lamp/sunrise-lamp11-959.webp 959w,
        sunrise_lamp/sunrise-lamp11-639.webp 639w,
        sunrise_lamp/sunrise-lamp11-320.webp 320w" data-sizes=100w><img alt="reduce height of heatsink" class="lazy blog-image-padding w3-hover-shadow" data-src=sunrise_lamp/sunrise-lamp11-1278.jpg data-srcset="sunrise_lamp/sunrise-lamp11.jpg 1278w,
        sunrise_lamp/sunrise-lamp11-959.jpg 959w,
        sunrise_lamp/sunrise-lamp11-639.jpg 639w,
        sunrise_lamp/sunrise-lamp11-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center></h5></a></div></div><div class="w3-container sc-multi-section sc-mobile"><div class="w3-panel w3-card-2 w3-leftbar w3-rightbar sc-quote sc-mobile-quote"><p>I wouldn’t usually recommend reducing the size of a heatsink, but as the lamp will only be in operation for 45 minutes per day the heat build up should be minimal.</p></div></div><div class="w3-row w3-padding-32 sc-multi-section sc-mobile"><div class="w3_container w3-half w3-left-align w3-padding-large sc-padding-lr"><h4 id=soldering-the-wemos-d1-mini-pins>Soldering the WeMos D1 Mini Pins</h4><p>I used 2 blocks of pins, a 2 & a 4 as shown.</p><ul><li>Pins: 5v & G</li><li>Pins: D6, D7, D8 & 3.3v</li></ul></div><div class="w3_container w3-half w3-padding-large sc-padding-lr"><a href=sunrise_lamp/sunrise-lamp05.jpg target=_blank><picture>
<source type=image/webp data-srcset="sunrise_lamp/sunrise-lamp05.webp 1278w,
        sunrise_lamp/sunrise-lamp05-959.webp 959w,
        sunrise_lamp/sunrise-lamp05-639.webp 639w,
        sunrise_lamp/sunrise-lamp05-320.webp 320w" data-sizes=100w><img alt="soldering pins on d1-mini" class="lazy blog-image-padding w3-hover-shadow" data-src=sunrise_lamp/sunrise-lamp05-1278.jpg data-srcset="sunrise_lamp/sunrise-lamp05.jpg 1278w,
        sunrise_lamp/sunrise-lamp05-959.jpg 959w,
        sunrise_lamp/sunrise-lamp05-639.jpg 639w,
        sunrise_lamp/sunrise-lamp05-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center></h5></a></div></div><div class="w3-row w3-padding-32 sc-multi-section sc-mobile"><div class="w3_container w3-half w3-left-align w3-padding-large sc-padding-lr"><h4 id=insert-and-connect-components>Insert and connect components</h4><p>The electronics are held in place with a dab of hot glue</p><p>I’ve shortened standard length Dupont connection wires, I really need to invest in a crimping kit as it would save me a lot of time and produce a better finished look.</p></div><div class="w3_container w3-half w3-padding-large sc-padding-lr"><a href=sunrise_lamp/sunrise-lamp14.jpg target=_blank><picture>
<source type=image/webp data-srcset="sunrise_lamp/sunrise-lamp14.webp 1278w,
        sunrise_lamp/sunrise-lamp14-959.webp 959w,
        sunrise_lamp/sunrise-lamp14-639.webp 639w,
        sunrise_lamp/sunrise-lamp14-320.webp 320w" data-sizes=100w><img alt="sunrise lamp wiring" class="lazy blog-image-padding w3-hover-shadow" data-src=sunrise_lamp/sunrise-lamp14-1278.jpg data-srcset="sunrise_lamp/sunrise-lamp14.jpg 1278w,
        sunrise_lamp/sunrise-lamp14-959.jpg 959w,
        sunrise_lamp/sunrise-lamp14-639.jpg 639w,
        sunrise_lamp/sunrise-lamp14-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center></h5></a></div></div><div class="w3-container sc-multi-section sc-mobile"><ul class="w3-ul w3-card sc-partlist sc-mobile"><hr><blockquote><h4 id=wiring-connections><em><strong>Wiring Connections</strong></em></h4></blockquote><ol><li><p>Hi-Link AC supply.</p></li><li><p>Hi-Link AC supply.</p></li><li><p>DC Negative connection spliced to WeMos Ground pin.</p></li><li><p>DC Positive connected to WeMos 5v pin.</p></li><li><p>Dimmer Ground pin spliced to WeMos G pin.</p></li><li><p>Dimmer VCC pin connected to WeMos 3.3v</p></li><li><p>Dimmer Z-C pin connected to WeMos D6 pin.</p></li><li><p>Dimmer PWM pin connected to WeMos D7 pin.</p></li></ol></ul></div><div class="w3-container sc-multi-end-section sc-mobile"><div class="w3-panel w3-card-2 w3-leftbar w3-rightbar sc-quote sc-mobile-quote"><p>Cutting the lamp power cable to leave approx. 100mm on the bulb side. Tin the ends with a small amount of solder & also solder the Hi-Link AC supply wires to the power supply wires. Secure in the dimmer connection blocks as shown.</p></div></div><div class="w3-container sc-top-section sc-mobile"><a href=sunrise_lamp/sunrise-lamp09.jpg target=_blank><picture>
<source type=image/webp data-srcset="sunrise_lamp/sunrise-lamp09.webp 1278w,
        sunrise_lamp/sunrise-lamp09-959.webp 959w,
        sunrise_lamp/sunrise-lamp09-639.webp 639w,
        sunrise_lamp/sunrise-lamp09-320.webp 320w" data-sizes=100w><img alt="Sunrise Alarm Lamp finished wiring" class="lazy blog-image-padding w3-hover-shadow" data-src=sunrise_lamp/sunrise-lamp09-1278.jpg data-srcset="sunrise_lamp/sunrise-lamp09.jpg 1278w,
        sunrise_lamp/sunrise-lamp09-959.jpg 959w,
        sunrise_lamp/sunrise-lamp09-639.jpg 639w,
        sunrise_lamp/sunrise-lamp09-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>Finished Sunrise Alarm Lamp wiring</h5></a></div></div></div><div class="w3-container sc-section-ad sc-mobile"><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-1748277873952415 data-ad-slot=2611434208 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="w3-container sc-section sc-mobile"><div class="w3-container sc-header-section sc-mobile sc-padding-lr"><header><h2>Setting Up</h2><hr class=sub><h5>Programming the WeMos D1 Mini</h5></header></div><div class="w3-container sc-sub-section sc-mobile"><div class="w3-container sc-top-section sc-mobile"><div class="w3-container sc-text-block-clear sc-mobile sc-padding-lr"><p>I already use Node Red & MQTT running on my Raspberry Pi to control various devices around the house, so I wanted to integrate the diy sunrise lamp into the same system.</p><p>The main part of the code that controls the dimmer board came Nassir Malik’s GitHub page <strong><a style=text-transform:capitalize;color:#2196f3;text-decoration:underline href=https://github.com/nassir-malik/IOT-AC-Light-Dimmer-With-Alexa/tree/master/Part%20%23%201/robodyn_dimmer>HERE</a></strong>. I would like to thank him for his work, really helped me out.</p><p>I added Wi-Fi and MQTT support and included a routine that would increase the brightness of the diy sunrise lamp over a 30 minute period.</p></div></div><div class="w3-container sc-multi-section sc-mobile"><div class="w3-container sc-text-block-code sc-mobile sc-padding-lr"><div class=highlight><pre style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#007020>#include</span> <span style=color:#007020>&#34;hw_timer.h&#34;</span><span style=color:#007020>
</span><span style=color:#007020>#include</span> <span style=color:#007020>&lt;ESP8266WiFi.h&gt;</span><span style=color:#007020>
</span><span style=color:#007020>#include</span> <span style=color:#007020>&lt;PubSubClient.h&gt;</span><span style=color:#007020>
</span><span style=color:#007020></span><span style=color:#60a0b0;font-style:italic>// Change the credentials below, so your ESP8266 connects to your router
</span><span style=color:#60a0b0;font-style:italic></span><span style=color:#007020;font-weight:700>const</span> <span style=color:#902000>char</span><span style=color:#666>*</span> ssid <span style=color:#666>=</span> <span style=color:#4070a0>&#34;Your SSID&#34;</span>;
<span style=color:#007020;font-weight:700>const</span> <span style=color:#902000>char</span><span style=color:#666>*</span> password <span style=color:#666>=</span> <span style=color:#4070a0>&#34;Your Password&#34;</span>;
<span style=color:#60a0b0;font-style:italic>// Change the variable to your Raspberry Pi IP address, so it connects to your MQTT broker
</span><span style=color:#60a0b0;font-style:italic></span><span style=color:#007020;font-weight:700>const</span> <span style=color:#902000>char</span><span style=color:#666>*</span> mqtt_server <span style=color:#666>=</span> <span style=color:#4070a0>&#34;MQTT Server IP Address&#34;</span>;
<span style=color:#60a0b0;font-style:italic>// Initializes the espClient. You should change the espClient name if you have multiple ESPs running in your home automation system
</span><span style=color:#60a0b0;font-style:italic></span>WiFiClient sunrise;
PubSubClient <span style=color:#06287e>client</span>(sunrise);

<span style=color:#007020;font-weight:700>const</span> byte zcPin <span style=color:#666>=</span> <span style=color:#40a070>12</span>;
<span style=color:#007020;font-weight:700>const</span> byte pwmPin <span style=color:#666>=</span> <span style=color:#40a070>13</span>;

byte fade <span style=color:#666>=</span> <span style=color:#40a070>1</span>;
byte state <span style=color:#666>=</span> <span style=color:#40a070>1</span>;
byte tarBrightness <span style=color:#666>=</span> <span style=color:#40a070>5</span>;
byte curBrightness <span style=color:#666>=</span> <span style=color:#40a070>0</span>;
byte zcState <span style=color:#666>=</span> <span style=color:#40a070>0</span>; <span style=color:#60a0b0;font-style:italic>// 0 = ready; 1 = processing;
</span><span style=color:#60a0b0;font-style:italic></span>
<span style=color:#902000>void</span> ICACHE_RAM_ATTR <span style=color:#06287e>zcDetectISR</span> ();
<span style=color:#902000>void</span> ICACHE_RAM_ATTR <span style=color:#06287e>dimTimerISR</span> ();
<span style=color:#902000>int</span> val <span style=color:#666>=</span> <span style=color:#40a070>1</span>;
<span style=color:#902000>int</span> tim <span style=color:#666>=</span> <span style=color:#40a070>1</span>;
String lampState <span style=color:#666>=</span> <span style=color:#4070a0>&#34;off&#34;</span>;

<span style=color:#902000>void</span> <span style=color:#06287e>setup_wifi</span>() {
  delay(<span style=color:#40a070>10</span>);
  Serial.println();
  Serial.print(<span style=color:#4070a0>&#34;Connecting to &#34;</span>);
  Serial.println(ssid);
  WiFi.begin(ssid, password);
  <span style=color:#007020;font-weight:700>while</span> (WiFi.status() <span style=color:#666>!=</span> WL_CONNECTED) {
    delay(<span style=color:#40a070>500</span>);
    Serial.print(<span style=color:#4070a0>&#34;.&#34;</span>);
  }
  Serial.println(<span style=color:#4070a0>&#34;&#34;</span>);
  Serial.print(<span style=color:#4070a0>&#34;WiFi connected - ESP IP address: &#34;</span>);
  Serial.println(WiFi.localIP());
}
<span style=color:#902000>void</span> <span style=color:#06287e>callback</span>(String topic, byte<span style=color:#666>*</span> message, <span style=color:#902000>unsigned</span> <span style=color:#902000>int</span> length) {
  Serial.print(<span style=color:#4070a0>&#34;Message arrived on topic: &#34;</span>);
  Serial.print(topic);
  Serial.print(<span style=color:#4070a0>&#34;. Message: &#34;</span>);
  String messageTemp;

  <span style=color:#007020;font-weight:700>for</span> (<span style=color:#902000>int</span> i <span style=color:#666>=</span> <span style=color:#40a070>0</span>; i <span style=color:#666>&lt;</span> length; i<span style=color:#666>++</span>) {
    Serial.print((<span style=color:#902000>char</span>)message[i]);
    messageTemp <span style=color:#666>+=</span> (<span style=color:#902000>char</span>)message[i];
  }
  Serial.println();
  <span style=color:#007020;font-weight:700>if</span> (topic <span style=color:#666>==</span> <span style=color:#4070a0>&#34;sunriseLamp/state&#34;</span>) {
    Serial.print(<span style=color:#4070a0>&#34;Turning on Outside light &#34;</span>);
    <span style=color:#007020;font-weight:700>if</span> (messageTemp <span style=color:#666>==</span> <span style=color:#4070a0>&#34;on&#34;</span>) {
      lampState <span style=color:#666>=</span> <span style=color:#4070a0>&#34;on&#34;</span>;
      Serial.print(<span style=color:#4070a0>&#34;On&#34;</span>);
    }
    <span style=color:#007020;font-weight:700>else</span> <span style=color:#007020;font-weight:700>if</span> (messageTemp <span style=color:#666>==</span> <span style=color:#4070a0>&#34;off&#34;</span>) {
      lampState <span style=color:#666>=</span> <span style=color:#4070a0>&#34;off&#34;</span>;
      Serial.print(<span style=color:#4070a0>&#34;Off&#34;</span>);
    }
  }
  Serial.println();
}
<span style=color:#60a0b0;font-style:italic>// This functions reconnects your ESP8266 to your MQTT broker
</span><span style=color:#60a0b0;font-style:italic>// Change the function below if you want to subscribe to more topics with your ESP8266
</span><span style=color:#60a0b0;font-style:italic></span><span style=color:#902000>void</span> <span style=color:#06287e>reconnect</span>() {
  <span style=color:#60a0b0;font-style:italic>// Loop until we&#39;re reconnected
</span><span style=color:#60a0b0;font-style:italic></span>  <span style=color:#007020;font-weight:700>while</span> (<span style=color:#666>!</span>client.connected()) {
    Serial.print(<span style=color:#4070a0>&#34;Attempting MQTT connection...&#34;</span>);
    <span style=color:#60a0b0;font-style:italic>// Attempt to connect
</span><span style=color:#60a0b0;font-style:italic></span>    <span style=color:#007020;font-weight:700>if</span> (client.connect(<span style=color:#4070a0>&#34;D1Mini_sunriseLamp&#34;</span>)) {
      Serial.println(<span style=color:#4070a0>&#34;connected&#34;</span>);
      <span style=color:#60a0b0;font-style:italic>// Subscribe or resubscribe to a topic
</span><span style=color:#60a0b0;font-style:italic></span>      <span style=color:#60a0b0;font-style:italic>// You can subscribe to more topics (to control more LEDs in this example)
</span><span style=color:#60a0b0;font-style:italic></span>      client.subscribe(<span style=color:#4070a0>&#34;sunriseLamp/state&#34;</span>);
    } <span style=color:#007020;font-weight:700>else</span> {
      Serial.print(<span style=color:#4070a0>&#34;failed, rc=&#34;</span>);
      Serial.print(client.state());
      Serial.println(<span style=color:#4070a0>&#34; try again in 5 seconds&#34;</span>);
      <span style=color:#60a0b0;font-style:italic>// Wait 5 seconds before retrying
</span><span style=color:#60a0b0;font-style:italic></span>      delay(<span style=color:#40a070>5000</span>);
    }
  }
}
<span style=color:#902000>void</span> <span style=color:#06287e>setup</span>() {
  Serial.begin(<span style=color:#40a070>115200</span>);
  setup_wifi();
  client.setServer(mqtt_server, <span style=color:#40a070>1883</span>);
  client.setCallback(callback);
  pinMode(zcPin, INPUT_PULLUP);
  pinMode(pwmPin, OUTPUT);
  attachInterrupt(zcPin, zcDetectISR, RISING);    <span style=color:#60a0b0;font-style:italic>// Attach an Interupt to Pin 2 (interupt 0) for Zero Cross Detection
</span><span style=color:#60a0b0;font-style:italic></span>  hw_timer_init(NMI_SOURCE, <span style=color:#40a070>0</span>);
  hw_timer_set_func(dimTimerISR);
}
<span style=color:#902000>void</span> <span style=color:#06287e>mqttCheck</span>() {
  <span style=color:#007020;font-weight:700>if</span> (<span style=color:#666>!</span>client.connected()) {
    reconnect();
  }
  <span style=color:#007020;font-weight:700>if</span> (<span style=color:#666>!</span>client.loop())
    client.connect(<span style=color:#4070a0>&#34;D1Mini_sunriseLamp&#34;</span>);
}
<span style=color:#902000>void</span> <span style=color:#06287e>loop</span>() {
  <span style=color:#007020;font-weight:700>if</span> (WiFi.status() <span style=color:#666>!=</span> WL_CONNECTED) {
    delay(<span style=color:#40a070>1</span>);
    setup_wifi();
    <span style=color:#007020;font-weight:700>return</span>;
  }
  mqttCheck();
  <span style=color:#007020;font-weight:700>if</span> (lampState <span style=color:#666>==</span> <span style=color:#4070a0>&#34;off&#34;</span>) state <span style=color:#666>=</span> <span style=color:#40a070>0</span>;
  <span style=color:#007020;font-weight:700>if</span> (lampState <span style=color:#666>==</span> <span style=color:#4070a0>&#34;on&#34;</span>) {
    val <span style=color:#666>=</span> <span style=color:#40a070>1</span>;
    state <span style=color:#666>=</span> <span style=color:#40a070>1</span>;
    <span style=color:#007020;font-weight:700>for</span> (val <span style=color:#666>&lt;=</span> <span style=color:#40a070>250</span>; val<span style=color:#666>++</span>;) {
      tarBrightness <span style=color:#666>=</span> val;
      mqttCheck();
      <span style=color:#007020;font-weight:700>if</span> (lampState <span style=color:#666>==</span> <span style=color:#4070a0>&#34;off&#34;</span>) {
        state <span style=color:#666>=</span> <span style=color:#40a070>0</span>;
        Serial.println(lampState);
        <span style=color:#007020;font-weight:700>break</span>;
      }
      delay(<span style=color:#40a070>7200</span>);
    }
  }
}
<span style=color:#902000>void</span> <span style=color:#06287e>dimTimerISR</span>() {
  <span style=color:#007020;font-weight:700>if</span> (fade <span style=color:#666>==</span> <span style=color:#40a070>1</span>) {
    <span style=color:#007020;font-weight:700>if</span> (curBrightness <span style=color:#666>&gt;</span> tarBrightness <span style=color:#666>||</span> (state <span style=color:#666>==</span> <span style=color:#40a070>0</span> <span style=color:#666>&amp;&amp;</span> curBrightness <span style=color:#666>&gt;</span> <span style=color:#40a070>0</span>)) {
      <span style=color:#666>--</span>curBrightness;
    }
    <span style=color:#007020;font-weight:700>else</span> <span style=color:#007020;font-weight:700>if</span> (curBrightness <span style=color:#666>&lt;</span> tarBrightness <span style=color:#666>&amp;&amp;</span> state <span style=color:#666>==</span> <span style=color:#40a070>1</span> <span style=color:#666>&amp;&amp;</span> curBrightness <span style=color:#666>&lt;</span> <span style=color:#40a070>255</span>) {
      <span style=color:#666>++</span>curBrightness;
    }
  }
  <span style=color:#007020;font-weight:700>else</span> {
    <span style=color:#007020;font-weight:700>if</span> (state <span style=color:#666>==</span> <span style=color:#40a070>1</span>) {
      curBrightness <span style=color:#666>=</span> tarBrightness;
    }
    <span style=color:#007020;font-weight:700>else</span> {
      curBrightness <span style=color:#666>=</span> <span style=color:#40a070>0</span>;
    }
  }
  <span style=color:#007020;font-weight:700>if</span> (curBrightness <span style=color:#666>==</span> <span style=color:#40a070>0</span>) {
    state <span style=color:#666>=</span> <span style=color:#40a070>0</span>;
    digitalWrite(pwmPin, <span style=color:#40a070>0</span>);
  }
  <span style=color:#007020;font-weight:700>else</span> <span style=color:#007020;font-weight:700>if</span> (curBrightness <span style=color:#666>==</span> <span style=color:#40a070>255</span>) {
    state <span style=color:#666>=</span> <span style=color:#40a070>1</span>;
    digitalWrite(pwmPin, <span style=color:#40a070>1</span>);
  }
  <span style=color:#007020;font-weight:700>else</span> {
    digitalWrite(pwmPin, <span style=color:#40a070>1</span>);
  }
  zcState <span style=color:#666>=</span> <span style=color:#40a070>0</span>;
}
<span style=color:#902000>void</span> <span style=color:#06287e>zcDetectISR</span>() {
  <span style=color:#007020;font-weight:700>if</span> (zcState <span style=color:#666>==</span> <span style=color:#40a070>0</span>) {
    zcState <span style=color:#666>=</span> <span style=color:#40a070>1</span>;

    <span style=color:#007020;font-weight:700>if</span> (curBrightness <span style=color:#666>&lt;</span> <span style=color:#40a070>255</span> <span style=color:#666>&amp;&amp;</span> curBrightness <span style=color:#666>&gt;</span> <span style=color:#40a070>0</span>) {
      digitalWrite(pwmPin, <span style=color:#40a070>0</span>);

      <span style=color:#902000>int</span> dimDelay <span style=color:#666>=</span> <span style=color:#40a070>30</span> <span style=color:#666>*</span> (<span style=color:#40a070>255</span> <span style=color:#666>-</span> curBrightness) <span style=color:#666>+</span> <span style=color:#40a070>400</span>;<span style=color:#60a0b0;font-style:italic>//400
</span><span style=color:#60a0b0;font-style:italic></span>      hw_timer_arm(dimDelay);
    }
  }
}
</code></pre></div></div></div><div class="w3-container sc-multi-section sc-mobile"><div class="w3-container sc-text-block-clear sc-mobile sc-padding-lr"><hr><h3 id=node-red-set-up-for-sunrise-lamp><strong>Node Red Set Up For Sunrise Lamp</strong></h3><p>I’m using 3 nodes in the flow.</p><ul><li>Big Timer Node – for more information refer to <strong><a style=text-transform:capitalize;color:#2196f3;text-decoration:underline href=https://tech.scargill.net/big-timer/>Scargill&rsquo;s Big-Timer</a></strong></li><li>Switch Node – used for a manual override.</li><li>Mqtt Output Node</li></ul></div></div><div class="w3-container sc-multi-section sc-mobile"><a href=sunrise_lamp/SunriseLamp-flow.jpg target=_blank><picture>
<source type=image/webp data-srcset="sunrise_lamp/SunriseLamp-flow.webp 1053w,
        sunrise_lamp/SunriseLamp-flow-790.webp 790w,
        sunrise_lamp/SunriseLamp-flow-527.webp 527w,
        sunrise_lamp/SunriseLamp-flow-263.webp 263w" data-sizes=100w><img alt="Screenshot of Node Red flow" class="lazy blog-image-padding w3-hover-shadow" data-src=sunrise_lamp/SunriseLamp-flow-1053.jpg data-srcset="sunrise_lamp/SunriseLamp-flow.jpg 1053w,
        sunrise_lamp/SunriseLamp-flow-790.jpg 790w,
        sunrise_lamp/SunriseLamp-flow-527.jpg 527w,
        sunrise_lamp/SunriseLamp-flow-263.jpg 263w" data-sizes=100w></picture><h5 class=w3-center>Screenshot of Node Red flow</h5></a></div><div class="w3-container sc-multi-section sc-mobile"><div class="w3-panel w3-card-2 w3-leftbar w3-rightbar sc-quote sc-mobile-quote"><p>I have been using the DIY Sunrise Lamp for a few days and although the light doesn’t wake me up every time, it is nice to not be in total darkness when my google home mini starts playing music.</p></div></div><div class="w3-container sc-multi-end-section sc-mobile"><a href=sunrise_lamp/sunrise-lamp07.jpg target=_blank><picture>
<source type=image/webp data-srcset="sunrise_lamp/sunrise-lamp07.webp 1278w,
        sunrise_lamp/sunrise-lamp07-959.webp 959w,
        sunrise_lamp/sunrise-lamp07-639.webp 639w,
        sunrise_lamp/sunrise-lamp07-320.webp 320w" data-sizes=100w><img alt="Homemade Sunrise Alarm Lamp" class="lazy blog-image-padding w3-hover-shadow" data-src=sunrise_lamp/sunrise-lamp07-1278.jpg data-srcset="sunrise_lamp/sunrise-lamp07.jpg 1278w,
        sunrise_lamp/sunrise-lamp07-959.jpg 959w,
        sunrise_lamp/sunrise-lamp07-639.jpg 639w,
        sunrise_lamp/sunrise-lamp07-320.jpg 320w" data-sizes=100w></picture><h5 class=w3-center>The Finished Sunrise Alarm Lamp</h5></a></div></div></div><div class="w3-container sc-section-ad sc-mobile"><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-1748277873952415 data-ad-slot=2611434208 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div></main><footer class="w3-container w3-theme-d2 w3-padding-16 w3-margin-top w3-center w3-card-4" id=myfooter><div><span class="w3-theme-d2 w3-hover-text-theme w3-margin-right" title=Homepage><a href=/>Homepage</a></span>
<span class="w3-theme-d2 w3-hover-text-theme w3-margin-right" title="Privacy Policy"><a href=/privacy-policy>Privacy Policy</a></span><div class="w3-center sc-padding-lr"><p><span class="w3-theme-d2 w3-hover-text-theme">&copy; 2020<a href=/making-a-diy-sunrise-lamp/> My Project Corner</a></span></p></div></footer><script>function w3_open(){document.getElementById("mySidebar").style.display="block";document.getElementById("myOverlay").style.display="block";}
function w3_close(){document.getElementById("mySidebar").style.display="none";document.getElementById("myOverlay").style.display="none";}</script><script>(function(){if(!localStorage.getItem('cookieconsent')){document.body.innerHTML+='\
          <div class="cookieconsent" style="position:fixed;padding:20px;left:0;bottom:0;background-color:darkslategrey;color:#FFF;text-align:center;width:100%;z-index:99999;">\
            This site uses cookies. By continuing to use this website, you agree to their use. \
              <a href="#" class="w3-button w3-round-xxlarge w3-theme-l5 w3-margin-left w3-animate-zoom"> OK</a>\
          </div>\
          ';document.querySelector('.cookieconsent a').onclick=function(e){e.preventDefault();document.querySelector('.cookieconsent').style.display='none';localStorage.setItem('cookieconsent',true);};}})();</script><script>var lazyLoadInstance=new LazyLoad({elements_selector:".lazy"});</script></body></html>